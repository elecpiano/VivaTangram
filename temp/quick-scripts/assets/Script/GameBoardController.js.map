{"version":3,"sources":["GameBoardController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["import FrameCanvasController from \"./FrameCanvasController\";\nimport Dictionary from \"./Dictionary\";\nimport GlobalData from \"./Global\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class GameBoardController extends cc.Component {\n\n    //#region Properties\n\n    @property(cc.Label)\n    ItemNumberLabel: cc.Label = null;\n    @property(cc.Label)\n    DisplayNameCN: cc.Label = null;\n    @property(cc.Label)\n    DisplayNameEN: cc.Label = null;\n    @property(cc.Node)\n    ProgressBar: cc.Node = null;\n    @property(cc.Node)\n    UIPanel: cc.Node = null;\n    @property(cc.Node)\n    ShapeCanvas: cc.Node = null;\n\n    ShapeCanvasAlphaMax = 150; // 0 is transparent, 255 is filled\n\n    @property(cc.Node)\n    Seq0: cc.Node = null;\n    @property(cc.Node)\n    Seq1: cc.Node = null;\n\n    @property(cc.Node)\n    Level0: cc.Node = null;\n    @property(cc.Node)\n    Level1: cc.Node = null;\n    @property(cc.Node)\n    Level2: cc.Node = null;\n    @property(cc.Node)\n    Level3: cc.Node = null;\n    @property(cc.Node)\n    Level4: cc.Node = null;\n    @property(cc.Node)\n    Level5: cc.Node = null;\n    @property(cc.Node)\n    Level6: cc.Node = null;\n    @property(cc.Node)\n    Level7: cc.Node = null;\n    @property(cc.Node)\n    Level8: cc.Node = null;\n\n    SeqButtons = new Array<cc.Node>();\n    SeqSpriteFrames = new Array<cc.SpriteFrame>();\n\n    LevelButtons = new Array<cc.Node>();\n    LevelSpriteFrames = new Array<cc.SpriteFrame>();\n\n    @property(FrameCanvasController)\n    FrameController: FrameCanvasController = null;\n\n    draw: cc.Graphics;\n    TangramColors:string[] = [\"#ffda4c\",\"#52cad1\",\"#ff493a\",\"#3968bc\",\"#ff8e2f\",\"#ca4c89\",\"#55d723\"];\n    ShowTangramFullColor:boolean = false;\n    // SHAPE_LINE_WIDTH = 5;\n\n    Difficulty = 0; // 0 is most difficult, 7 shows all shapes(without color), 8 shows all shapes with color\n    HintColors:string[] = [\"#5faace\",\"#3992bc\",\"#287ca3\",\"#19678b\",\"#105778\",\"#074561\",\"#05354b\"];\n    HintColorRemap = Array<number>();\n\n    ParamData = Array<string>();\n    DictionaryData = Array<string>();\n    DisplayNameDictionary: Dictionary<string,string[]>;\n    DISPLAY_NAME_DURATION = 0.5;\n\n    Dots = Array<cc.Vec2>();\n    Shapes = Array<string>();\n    Frames = Array<string>();\n    CurrentDisplayNameKey = \"\";\n\n    AppearQueue = Array<number>();\n    ShownShpaes = Array<number>();\n    UnshownShpaes = Array<number>();\n    drawDuration: number = 0.2;\n    drawInterval: number = 0.05;\n    drawTimeList = new Array<number>();\n    drawingList = new Array<number>();\n\n    PRGRESS_DURATION = 0.7;\n    \n    TangramIndex = 0;\n    NavigatedFromListView:boolean = false;\n    \n    SeqMode = 0;// 0 - Sequence, 1 - Suffle\n    VisitedList = Array<number>();\n    UnvisitedList = Array<number>();\n\n    IsBusy = false;\n\n    //#endregion\n\n    //#region Navigation\n\n    NavigateToListView(){\n        cc.director.loadScene(\"ListView\");\n    }\n\n    //#endregion\n\n    //#region Lifecycle\n\n    onLoad () {\n        let globalNode = cc.director.getScene().getChildByName('GlobalNode');       \n        this.TangramIndex = globalNode.getComponent(GlobalData).SelectedItemIndex;\n        this.NavigatedFromListView = globalNode.getComponent(GlobalData).NavigatedFromListView;\n        globalNode.getComponent(GlobalData).NavigatedFromListView = false;\n\n        this.LoadData();\n        this.UIPanel.opacity = 0;\n        if (this.animations == null) {\n            this.animations = this.getComponent(cc.Animation);\n        }\n    }\n\n    start () {\n        this.draw = this.ShapeCanvas.getComponent(cc.Graphics);\n        if (!this.draw) {\n            this.draw = this.ShapeCanvas.addComponent(cc.Graphics);\n        }\n\n        this.ShowProgressBar();\n    }\n\n    update (dt) {\n        if (this.drawingList.length > 0) {\n            this.UpdateRender(dt);\n        }\n    }\n\n    DoThingsAfterProgress(){\n        //hide progress bar\n        this.ProgressBar.setScale(0,1);\n\n        this.InitMenu();\n\n        //show UI Panel\n        this.UIPanel.opacity = 255;\n\n        //dictionary\n        this.PrepareDictionary();\n\n        // user data\n        this.EnsureUserDataAccess();\n        let data = this.GetUserData();\n        let strArr = data.split(\";\");\n        if (strArr.length == 4) {\n            if (!this.NavigatedFromListView) {\n                this.TangramIndex = Number(strArr[0]);                \n            }\n            this.Difficulty = Number(strArr[1]);\n            this.SeqMode = Number(strArr[2]);\n            //visited list\n            this.InitVisitList(strArr[3]);\n        }\n\n        // sync diff menu\n        this.SyncSeqMenu();\n        this.SyncDiffMenu();\n\n        //show tangram\n        this.ShowTangram();\n    }\n\n    SyncVistList(){\n        let i = 0;\n        let idx = null;\n        while (i < this.UnvisitedList.length) {\n            if (this.TangramIndex == this.UnvisitedList[i]) {\n                idx = this.UnvisitedList.splice(i,1);\n                this.VisitedList.push(idx);\n                break;\n            }\n            i++;\n        }\n\n        // if all tangrams have been visited, reset\n        if (this.UnvisitedList.length == 0) {\n            this.InitVisitList(\"\");\n        }\n    }\n\n    InitVisitList(visitStr:string){\n        //visited list\n        this.VisitedList.splice(0,this.VisitedList.length);\n        let visitArr = visitStr.split(\",\");        \n        for (let i = 0; i < visitArr.length; i++) {\n            if (visitArr[i] != \"\") {\n                this.VisitedList.push(Number(visitArr[i]));\n            }\n        }\n\n        //unvisited list\n        this.UnvisitedList.splice(0,this.UnvisitedList.length);\n        for (let i = 0; i < this.ParamData.length; i++) {\n            let visited = false;\n            let j = 0;\n            while (j < this.VisitedList.length) {\n                if (i == this.VisitedList[j]) {\n                    visited = true;\n                    break;\n                }\n                j++;\n            }\n\n            if (!visited) {\n                this.UnvisitedList.push(i);\n            }\n        }\n        console.log(\"xxx unvisited list : \" + this.UnvisitedList);\n    }\n\n    //#endregion\n\n    //#region Param Data & Dictionary\n\n    LoadData(){\n        cc.loader.loadRes(\n            \"param\",\n            (error, txt:string)=>{\n                this.ParamData = txt.split(\"\\n\");\n            }\n        );\n\n        cc.loader.loadRes(\n            \"dictionary\",\n            (error, txt:string)=>{\n                this.DictionaryData = txt.split(\"\\n\");\n            }\n        );\n    }\n\n    PrepareDictionary(){\n        if (this.DisplayNameDictionary == null) {\n            this.DisplayNameDictionary = new Dictionary<string,string[]>();\n\n            for (let i = 0; i < this.DictionaryData.length; i++) {\n                let str = this.DictionaryData[i];\n                let arr = str.split(\",\");\n                if (arr.length == 3) {\n                    let key = arr[0];\n                    arr.splice(0,1);\n                    this.DisplayNameDictionary.Add(key, arr);\n                }\n            }\n        }\n    }\n\n    //#endregion\n\n    //#region Tangram Render\n    \n    ShowTangram(){\n        this.IsBusy = true;\n\n        this.ClearTangram();\n        this.PrepareParam();\n\n        this.ShowTangramFullColor = this.Difficulty == 8 ? true : false;\n        let appearCount = Math.min(this.Difficulty, 7);// this.Difficulty may go up to 8\n        \n        this.node.runAction(cc.sequence(\n            cc.callFunc(()=>this.FrameController.StartDraw(this.Dots, this.Frames),this),\n            cc.delayTime(0.5),\n            cc.callFunc(()=>this.StartDraw(appearCount),this)\n        ));\n\n        this.ShowDisplayName();\n\n        this.SaveUserData();\n    }\n\n    PrepareParam(){\n        let param = this.ParamData[this.TangramIndex];\n        \n        // begin prepare\n        let paramArray = param.split(\"/\");\n\n        // dots\n        this.Dots.splice(0,this.Dots.length);\n        let dotsPositonStr = paramArray[0].split(\";\");\n        for (let i = 0; i < dotsPositonStr.length; i++) {\n            let posStr = dotsPositonStr[i];\n            let x = Math.round(Number(posStr.split(\",\")[0]));\n            let y = Math.round(Number(posStr.split(\",\")[1]));\n            // let dotPosition = new cc.Vec2(x,512 - y);\n            let dotPosition = new cc.Vec2(x * 2,1024 - y * 2);\n            this.Dots.push(dotPosition);\n        }\n\n        //shapes\n        this.Shapes.splice(0,this.Shapes.length);\n        let shapeListStr = paramArray[1].split(\";\");\n        for (let i = 0; i < shapeListStr.length; i++) {\n            let shapeStr = shapeListStr[i];\n            this.Shapes.push(shapeStr);\n        }\n\n        //frames\n        this.Frames.splice(0,this.Frames.length);\n        let frameListStr = paramArray[2].split(\";\");\n        for (let i = 0; i < frameListStr.length; i++) {\n            let frameStr = frameListStr[i];\n            this.Frames.push(frameStr);\n        }\n\n        //display name key\n        if (paramArray.length > 3) {\n            this.CurrentDisplayNameKey = paramArray[3].trim();            \n        }\n        else{\n            this.CurrentDisplayNameKey = \"\";\n        }\n    }\n\n    StartDraw(appearCount:number){\n        if (appearCount > 7) {\n            return;\n        }\n\n        this.draw.clear();\n\n        // randomize appear queue, populate shown shapes\n        let tempQueue = [ 0, 1, 2, 3, 4, 5, 6 ];\n        this.AppearQueue.splice(0,this.AppearQueue.length);\n        this.ShownShpaes.splice(0,this.ShownShpaes.length);\n        this.UnshownShpaes.splice(0,this.UnshownShpaes.length);\n\n        while (this.AppearQueue.length < appearCount) {\n            let rand = Math.floor(Math.random() * tempQueue.length);\n            let idx = tempQueue.splice(rand,1)[0];\n            this.AppearQueue.push(idx);\n            this.ShownShpaes.push(idx);\n        }\n\n        // record unshown shapes\n        while (tempQueue.length > 0) {\n            let idx = tempQueue.pop();\n            this.UnshownShpaes.push(idx);\n        }\n\n        // randomize hint color\n        tempQueue = [ 0, 1, 2, 3, 4, 5, 6 ];\n        this.HintColorRemap.splice(0,this.HintColorRemap.length);\n        while (tempQueue.length > 0) {\n            let rand = Math.floor(Math.random() * tempQueue.length);\n            let idx = tempQueue.splice(rand,1)[0];\n            this.HintColorRemap.push(idx);\n        }\n        \n        // drawTimeList\n        this.drawTimeList.splice(0,this.drawTimeList.length);\n        this.drawTimeList = [0,0,0,0,0,0,0];\n\n        if (this.AppearQueue.length > 0) {\n            this.ShowNextShape();            \n        }\n        else{\n            this.IsBusy = false;\n            console.log(\"xxx - unbusy at StartDraw\");\n        }\n    }\n\n    ShowNextShape(){\n        if (this.AppearQueue.length>0) {\n            let idx = this.AppearQueue.pop();\n            this.drawingList.push(idx); /* this will trigger corresponding drawtime begin to tick */\n\n            this.node.runAction(cc.sequence(\n                cc.delayTime(this.drawInterval),\n                cc.callFunc(()=>this.ShowNextShape(),this)\n            ));\n        }\n    }\n\n    ShowOneMoreHint(){\n        if (this.UnshownShpaes.length == 0) {\n            this.IsBusy = true;\n            this.ShowTangramFullColor = true;\n            this.StartDraw(7);\n        }\n        else{\n            let rand = Math.floor(Math.random() * this.UnshownShpaes.length);\n            let idx = this.UnshownShpaes.splice(rand,1)[0];\n            this.drawTimeList[idx] = 0;\n            this.drawingList.push(idx); /* this will trigger corresponding drawtime begin to tick */\n            this.IsBusy = true;\n        }\n    }\n\n    UpdateRender(dt: number){\n        let i = 0;\n        while (i < this.drawingList.length) {\n            if (this.drawTimeList[this.drawingList[i]] >= this.drawDuration) { \n                this.drawingList.splice(i,1);\n            }\n            else{\n                i++;\n            }\n        }\n\n        for (let i = 0; i < this.drawingList.length; i++) {\n            let index = this.drawingList[i];\n            if (this.drawTimeList[index] < this.drawDuration) { \n                this.drawTimeList[index] += dt;\n            }\n        }\n\n        this.draw.clear();\n\n        for (let i = 0; i < this.Shapes.length; i++) {\n            /* if alpha is greater than 255, it will re-count from 256 */\n            let alpha = this.ShapeCanvasAlphaMax * Math.min(this.drawTimeList[i],this.drawDuration)/this.drawDuration;\n            this.RenderShape(this.Shapes[i], i, alpha);\n        }\n\n        if (this.drawingList.length == 0) {\n            this.IsBusy = false;\n            console.log(\"xxx - unbusy at UpdateRender\");\n        }\n    }\n\n    RenderShape(shapeString:string, colorIndex:number, alpha: number){\n        let dots = shapeString.split(\",\");\n\n        let startX = 0;\n        let startY = 0;\n\n        let i = 0;\n        while (i < dots.length) {\n            let x = this.Dots[Number(dots[i])].x;\n            let y = this.Dots[Number(dots[i])].y;\n            if (i == 0) {\n                this.draw.moveTo(x,y);\n                startX = x;\n                startY = y;\n            }\n            else if(i == (dots.length/ - 2)){\n                this.draw.lineTo(startX,startY);\n            }\n            else{\n                this.draw.lineTo(x,y);\n            }\n            i ++;\n        }\n\n        this.draw.close();\n\n        if (this.ShowTangramFullColor) {\n            this.draw.fillColor = cc.hexToColor(this.TangramColors[colorIndex]);\n        }\n        else{\n            this.draw.fillColor = cc.hexToColor(this.HintColors[this.HintColorRemap[colorIndex]]);\n        }\n        this.draw.fillColor = this.draw.fillColor.setA(alpha);\n        this.draw.fill();\n\n        // // make each shape a bit larger, to avoid small gaps between shapes\n        // this.draw.lineWidth = this.SHAPE_LINE_WIDTH;\n        // this.draw.strokeColor = this.draw.fillColor.setA(alpha*0.2);\n        // this.draw.stroke();\n    }\n\n    ShowDisplayName(){\n        let nameCN = \"\";\n        let nameEN = \"\";\n        if (this.CurrentDisplayNameKey != \"\") {\n            let names = this.DisplayNameDictionary.TryGetValue(this.CurrentDisplayNameKey);\n            if (names != null) {\n                nameCN = names[0].trim();\n                nameEN = names[1].trim();\n                this.DisplayNameAnimate();\n            }\n        }\n\n        this.ItemNumberLabel.string = \"No.\" + this.TangramIndex.toString();\n        this.DisplayNameEN.string = nameCN;\n        this.DisplayNameCN.string = nameEN;\n    }\n\n    DisplayNameAnimate(){\n        this.DisplayNameEN.node.opacity = 0;\n        this.DisplayNameCN.node.opacity = 0;\n        this.DisplayNameCN.node.runAction(cc.fadeIn(this.DISPLAY_NAME_DURATION));\n        this.DisplayNameEN.node.runAction(cc.fadeTo(this.DISPLAY_NAME_DURATION, 128));\n\n        // this.node.runAction(cc.sequence(\n        //     cc.delayTime(0.2),\n        //     cc.callFunc(\n        //         ()=>{\n        //             this.DisplayNameCN.node.runAction(cc.fadeIn(this.DISPLAY_NAME_DURATION));\n        //         },this)\n        // ));\n\n        // this.node.runAction(cc.sequence(\n        //     cc.delayTime(0.3),\n        //     cc.callFunc(\n        //         ()=>{\n        //             this.DisplayNameEN.node.runAction(cc.fadeIn(this.DISPLAY_NAME_DURATION));\n        //         },this)\n        // ));\n        \n    }\n\n    ClearTangram(){\n        this.draw.clear();\n        this.FrameController.ClearFrame();\n    }\n\n    //#endregion\n\n    //#region Button Logic\n\n    ShowNextTangram(){\n        if (this.IsBusy) {\n            return;\n        }\n\n        this.HideContextMenus();\n\n        //pick next tangram in data\n        if (this.SeqMode == 0) {\n            if (this.TangramIndex < this.ParamData.length-1 ) {\n                this.TangramIndex++;\n            }\n            else {\n                this.TangramIndex = 0;\n            }\n        }\n        else{\n            let rand = Math.floor(Math.random() * this.UnvisitedList.length);\n            this.TangramIndex = this.UnvisitedList[rand];\n        }\n\n        this.SyncVistList();\n\n        this.ShowTangram();\n    }\n\n    //#endregion\n\n    //#region Hint\n\n    GiveMeHint(){\n        if (this.IsBusy) {\n            return;\n        }\n\n        this.HideContextMenus();\n\n        this.ShowOneMoreHint();\n    }\n\n    //#endregion\n\n    //#region Progress Bar\n\n    ShowProgressBar(){\n        this.ProgressBar.setScale(0,1);\n        this.ProgressBar.runAction(cc.sequence(\n            cc.scaleTo(this.PRGRESS_DURATION, 1, 1),\n            cc.callFunc(()=>this.DoThingsAfterProgress())\n        ));\n    }\n\n    //#endregion\n\n    //#region Difficulty, Sequence\n\n    menuSeqOpen = false;\n    menuDiffOpen = false;\n    animations:cc.Animation = null;\n\n    InitMenu(){\n        // Level Buttons\n        this.Level1.scale = 0;;\n        this.Level2.scale = 0;\n        this.Level3.scale = 0;\n        this.Level4.scale = 0;\n        this.Level5.scale = 0;\n        this.Level6.scale = 0;\n        this.Level7.scale = 0;\n        this.Level8.scale = 0;\n\n        this.LevelButtons.push(this.Level0);\n        this.LevelButtons.push(this.Level1);\n        this.LevelButtons.push(this.Level2);\n        this.LevelButtons.push(this.Level3);\n        this.LevelButtons.push(this.Level4);\n        this.LevelButtons.push(this.Level5);\n        this.LevelButtons.push(this.Level6);\n        this.LevelButtons.push(this.Level7);\n        this.LevelButtons.push(this.Level8);\n\n        this.LevelSpriteFrames.push(this.Level0.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level1.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level2.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level3.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level4.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level5.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level6.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level7.getComponent(cc.Sprite).spriteFrame);\n        this.LevelSpriteFrames.push(this.Level8.getComponent(cc.Sprite).spriteFrame);\n\n        // Seq Buttons\n        this.Seq1.scale = 0;\n\n        this.SeqButtons.push(this.Seq0);\n        this.SeqButtons.push(this.Seq1);\n\n        this.SeqSpriteFrames.push(this.Seq0.getComponent(cc.Sprite).spriteFrame);\n        this.SeqSpriteFrames.push(this.Seq1.getComponent(cc.Sprite).spriteFrame);\n    }\n\n    TapSeqMenu(event, customEventData){\n        console.log(\"xxx TapSeqMenu : \");\n\n        if (this.IsBusy) {\n            return;\n        }\n\n        if (this.menuDiffOpen) {\n            this.HideDiffMenu();\n        }\n\n        if (this.menuSeqOpen) {\n            let idx = Number(customEventData);\n            if (idx == 1) {\n                this.SeqMode = this.SeqMode == 0 ? 1 : 0;\n            }\n\n            this.HideSeqMenu();\n            this.SyncSeqMenu();\n            this.SaveUserData();\n        }\n        else{\n            this.ShowSeqMenu();\n        }\n    }\n\n    SyncSeqMenu(){\n        this.Seq0.getComponent(cc.Sprite).spriteFrame = this.SeqSpriteFrames[this.SeqMode];\n        let idx = this.SeqMode == 0 ? 1 : 0;\n        this.Seq1.getComponent(cc.Sprite).spriteFrame = this.SeqSpriteFrames[idx];\n    }\n\n    TapDiffMenu(event, customEventData){\n        if (this.IsBusy) {\n            return;\n        }\n\n        if (this.menuSeqOpen) {\n            this.HideSeqMenu();\n        }\n        if (this.menuDiffOpen) {\n            let idx = Number(customEventData);\n            if (idx > 0 && idx <= this.Difficulty) {\n                this.Difficulty = idx - 1;\n            }\n            else if(idx > this.Difficulty){\n                this.Difficulty = idx;\n            }\n\n            this.HideDiffMenu();\n            this.SyncDiffMenu();\n            this.ApplyDiffMenu();\n            this.SaveUserData();\n        }\n        else{\n            this.ShowDiffMenu();\n        }\n    }\n\n    SyncDiffMenu(){\n        this.Level0.getComponent(cc.Sprite).spriteFrame = this.LevelSpriteFrames[this.Difficulty];\n\n        let idx = 1;\n        while (idx < this.LevelButtons.length) {\n            if (idx <= this.Difficulty) {\n                this.LevelButtons[idx].getComponent(cc.Sprite).spriteFrame = this.LevelSpriteFrames[idx - 1];                \n            }\n            else{\n                this.LevelButtons[idx].getComponent(cc.Sprite).spriteFrame = this.LevelSpriteFrames[idx];                                \n            }\n            idx ++;\n        }\n    }\n\n    ApplyDiffMenu(){\n        this.IsBusy = true;\n        this.ShowTangramFullColor = this.Difficulty == 8 ? true : false;\n        let appearCount = Math.min(this.Difficulty, 7);// this.Difficulty may go up to 8\n        this.StartDraw(appearCount);\n    }\n\n    HideContextMenus(){\n        if (this.menuDiffOpen) {\n            this.HideDiffMenu();\n        }\n        if (this.menuSeqOpen) {\n            this.HideSeqMenu();\n        }\n    }\n\n    ShowSeqMenu(){\n        this.animations.playAdditive(\"MenuSeqOpen\");\n        this.menuSeqOpen = true;\n    }\n\n    HideSeqMenu(){\n        this.animations.playAdditive(\"MenuSeqClose\");\n        this.menuSeqOpen = false;\n    }\n\n    ShowDiffMenu(){\n        this.animations.playAdditive(\"MenuDiffOpen\");\n        this.menuDiffOpen = true;\n    }\n\n    HideDiffMenu(){\n        this.animations.playAdditive(\"MenuDiffClose\");\n        this.menuDiffOpen = false;\n    }\n\n    //#endregion\n\n    //#region Test\n\n    Test(){\n        // console.log(\"xxx drawingList : \" + this.drawingList);\n        // console.log(\"xxx drawTimeList : \" + this.drawTimeList);\n        console.log(\"xxx UnvisitedList : \" + this.UnvisitedList);\n    }\n\n    //#endregion\n\n    //#region WX Data API\n\n    EnsureUserDataAccess(){\n        // if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n        // }\n        let fs = wx.getFileSystemManager();\n        let data = null;\n        try {\n            data = fs.readFileSync(`${wx.env.USER_DATA_PATH}/userdata.txt`, 'utf8');        \n        }catch(error){\n        }\n\n        if (data == null) {\n            fs.writeFileSync(`${wx.env.USER_DATA_PATH}/userdata.txt`, '0;0;0;0', 'utf8');\n        }\n    }\n\n    SaveUserData(){\n        let str = \"\";\n        str += this.TangramIndex.toString() + \";\";\n        str += this.Difficulty.toString() + \";\";\n        str += this.SeqMode.toString() + \";\";\n\n        for (let i = 0; i < this.VisitedList.length; i++) {\n            str += this.VisitedList[i].toString() + \",\";\n        }\n\n        let fs = wx.getFileSystemManager();\n        fs.writeFileSync(`${wx.env.USER_DATA_PATH}/userdata.txt`, str, 'utf8');\n        console.log(\"xxx save user data : \" + str);\n    }\n\n    GetUserData():string{\n        let fs = wx.getFileSystemManager();\n        let data = null;\n        try {\n            data = fs.readFileSync(`${wx.env.USER_DATA_PATH}/userdata.txt`, 'utf8');        \n        }catch(error){\n        }\n\n        return data;\n    }\n\n    //#endregion\n\n}\n"]}